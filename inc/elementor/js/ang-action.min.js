"use strict";jQuery(window).on("elementor:init",function(){var t=elementor.modules.controls.BaseData,e=t.extend({ui:function(){var e=t.prototype.ui.apply(this,arguments);return _.extend(e,{actionButton:"button"}),e},events:function(){var e=t.prototype.events.apply(this,arguments);return e["click @ui.actionButton"]="onChangeEvent",e},performAction:function(e){return this[{export_css:"handleCSSExport",reset_css:"handleCSSReset",save_token:"handleSaveToken"}[e]]()},onChangeEvent:function(e){var t=e.currentTarget,n=jQuery(t).data("action");this.performAction(n)},handleCSSExport:function(){var e=elementor.settings.page.getControlsCSS().elements.$stylesheetElement[0].textContent,t=elementor.settings.page.model.get("custom_css"),n=e.replace(t,""),a=cssbeautify(n,{indent:"    ",openbrace:"end-of-line",autosemicolon:!0}),o=elementorCommon.dialogsManager.createWidget("lightbox",{id:"ang-modal-export-css",headerMessage:"Export CSS",message:"",position:{my:"center",at:"center"},onReady:function(){this.addButton({name:"cancel",text:"Cancel",callback:function(){o.destroy()}}),this.addButton({name:"ok",text:"Copy CSS",callback:function(){var e=o.getElements("content");$(e.find("textarea")).select(),document.execCommand("copy")}})},onShow:function(){o.getElements("content").append('<textarea rows="10">'+a+"</textarea>")}});o.getElements("message").append(o.addElement("content")),o.show(),jQuery(window).resize()},handleCSSReset:function(){elementorCommon.dialogsManager.createWidget("confirm",{message:ANG_Action.translate.resetMessage,headerMessage:ANG_Action.translate.resetHeader,strings:{confirm:elementor.translate("yes"),cancel:elementor.translate("cancel")},defaultOption:"cancel",onConfirm:function(){var e=["typography","font_family","font_size","font_size_mobile","font_size_tablet","font_style","font_weight","line_height","line_height_mobile","line_height_tablet","letter_spacing","letter_spacing_mobile","letter_spacing_tablet","text_decoration","text_transform"];_.each(["ang_heading_1","ang_heading_2","ang_heading_3","ang_heading_4","ang_heading_5","ang_heading_6","ang_default_heading","ang_body","ang_paragraph"],function(n){_.each(e,function(e){var t=n+"_"+e;elementor.settings.page.model.setExternalChange(t,!1)})})}}).show()},handleSaveToken:function(){var e=elementor.settings.page.model.attributes,o={};_.map(e,function(e,t){t.startsWith("ang_")&&!t.startsWith("ang_action")&&(o[t]=e)});var s=elementorCommon.dialogsManager.createWidget("lightbox",{id:"ang-modal-save-token",headerMessage:ANG_Action.translate.saveToken,message:"",position:{my:"center",at:"center"},onReady:function(){this.addButton({name:"ok",text:ANG_Action.translate.cancel,callback:function(){s.destroy()}})},onShow:function(){var n=s.getElements("content");n.append('\n\t\t\t\t\t\t<input id="ang_token_title" type="text" value="" placeholder="'+ANG_Action.translate.enterTitle+'" />\n\t\t\t\t\t\t<button style="padding:10px;margin-top:10px;" class="elementor-button elementor-button-success" id="ang_save_token">\n\t\t\t\t\t\t\t<span class="elementor-state-icon"><i class="fa fa-spin fa-circle-o-notch" aria-hidden="true"></i></span>\n\t\t\t\t\t\t\t'+ANG_Action.translate.saveToken2+"\n\t\t\t\t\t\t</button>\n\t\t\t\t\t");var a=$("#ang_token_title");a.on("input",function(){$(this).css("border-color","#d5dadf")}),$("#ang-modal-save-token").on("click","#ang_save_token",function(e){e.preventDefault();var t=a.val();t||a.css("border-color","red"),$(this).addClass("elementor-button-state"),n.find(".error").remove(),t&&wp.apiFetch({url:ANG_Action.saveToken,method:"post",data:{id:elementor.config.post_id,title:t,tokens:JSON.stringify(o)}}).then(function(e){n.html("<p>"+e.message+"</p>"),$(this).removeClass("elementor-button-state"),setTimeout(function(){s.destroy()},2e3)}).catch(function(e){$(this).removeClass("elementor-button-state"),n.append('<p class="error" style="color:red;margin-top:10px;">'+e.message+"</p>")})})}});s.getElements("message").append(s.addElement("content")),s.show(),jQuery(window).resize()}});elementor.addControlView("ang_action",e),elementor.settings.page.addChangeCallback("ang_action_tokens",function(e){var t=$('select[data-setting="ang_action_tokens"]');$("#insert_token").length||$('<button id="insert_token" class="elementor-button elementor-button-success" style="padding:7px;margin-top:10px"><span class="elementor-state-icon"><i class="fa fa-spin fa-circle-o-notch" aria-hidden="true"></i></span>'+ANG_Action.translate.insertToken+"</button>").insertAfter(t.next());var n=$("#insert_token");n.attr("data-post",e);var a=n.attr("data-post");a&&n.on("click",function(){n.addClass("elementor-button-state"),wp.apiFetch({method:"post",path:"agwp/v1/tokens/get",data:{id:a}}).then(function(e){var t=JSON.parse(e.data);n.unbind(),Object.keys(t).length&&elementor.settings.page.model.set(t),elementor.settings.page.model.setExternalChange("ang_action_tokens",""),n.remove()}).catch(function(e){console.error(e)})})})});